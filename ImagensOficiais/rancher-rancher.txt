https://rancher.com/docs/rancher/v2.x/en/installation/other-installation-methods/single-node-docker/

1.Baixar
docker pull rancher/rancher

2.Criar Volume
Verifique se náo existe o nome
docker volume ls
Crie um volume
docker volume create rancher
Verifique se foi criado
docker volume ls

3.Ligar na rede desejada
Verifique quais redes existem
docker network ls
Verifique quais containers tëm na rede
Para criar a rede vá em:
https://github.com/renatomportugal/docker/blob/master/05.RedeDeContainers.md#organizando-os-containers
docker network inspect 
Utilize a rede escolhida

docker run \
  -d \
  -p 80:80 \
  -p 443:443 \
  -v rancher:/var/lib/rancher \
  --name rancher \
  --network bridge.66.6 \
  --ip 66.6.0.180 \
  --restart=always \
  rancher/rancher:latest

__ADICIONAR CLUSTER
Acesse o localhost ou endereço que foi instalado.
Vá em menu Clusters, botão Add Cluster, From existing nodes (Custom), Nomeie como cluster01, botão next.
Aguarde pelo provisionamento.

__
Edite o cluster01, em Customize Node Run Command, Selecione:
etcd
Control Plane

Copie a linha de comando, parecendo com:
sudo docker run -d --privileged --restart=unless-stopped --net=host -v /etc/kubernetes:/etc/kubernetes -v /var/run:/var/run rancher/rancher-agent:v2.4.5 --server https://192.168.1.106 --token h86gqvnq5wb4fw8hpnhzqqnbmprthrkf2k5xf5gd8x45bdfqdpnbrc --ca-checksum 70db14697fb1a4ae6d9d11da1c9568b31c3792306e7957576fb3f6afb83154a4 --etcd --controlplane --worker

Cole no terminal e execute, ele baixará o que for necessário para rodar.
Aguarde na tela de monitoramento que ficará pronta.




__ADICIONAR OS CONTAINERS
Vamos implantar (Deploy, adicionar) um container pelo próprio rancher.
Vá em Default, active, botão deploy.
Nome: php
Docker Image: php:7.1.26-apache
Add Port
Port Mapping:
Port Name: php.8001
Publish the container port: 80
Protocol: TCP
As a: HostPort
On listening port: 8001
Clica em Volumes, Add Volume (Bind-mount)
Volume Name: php.vol
Clicar em Launch


FUNCIONOU, ver se dá para mudar de porta.
__________________________________________________  
__Configurações
Dark mode
Clique na imagem, lado superior direito, Preferences, Them, Dark

Adicionar Cluste
Clique em Menu Cluster, botão Add Cluster no lado superior direito, From existing mode (Custom)
Nomeie (cluster01), Next
Em Node options selecione etcd, Control Plane e Worker. Copie o código...

sudo docker run -d --privileged --restart=unless-stopped --net=host -v /etc/kubernetes:/etc/kubernetes -v /var/run:/var/run rancher/rancher-agent:v2.4.5 --server https://192.168.1.106 --token v52ttj9shzwhzjs7t6vqgvl6h5mnlwsrcgsk5fk92qsz4jgfs898mg --ca-checksum 24393920386be9fd8d36ea0f52cf939e534be152b74c81574bc0a8c7c020c2ce --etcd --controlplane --worker

clique em Done, Vá no terminal, cole e execute o código.

Volte ao terminal e execute o comando top para verificar o processamento.

Vamos implantar (Deploy, adicionar) um container pelo próprio rancher.
Vá em Default, active, botão deploy.
Nome: nginx-8001
Docker Image: nginx
Add Port
Port Mapping:
Port Name: nginx.8001
Publish the container port: 80
Protocol: TCP
As a: HostPort
On listening port: 8001
Clica em Volumes, Add Volume (Bind-mount)
Volume Name: nginx.vol
Clicar em Launch



__________________________________________________  
 


docker run -d --restart=unless-stopped \
  -p 80:80 -p 443:443 \
  rancher/rancher:latest
  
  docker run -d --restart=unless-stopped \
  -p 80:80 -p 443:443 \
  -v /<CERT_DIRECTORY>/<FULL_CHAIN.pem>:/etc/rancher/ssl/cert.pem \
  -v /<CERT_DIRECTORY>/<PRIVATE_KEY.pem>:/etc/rancher/ssl/key.pem \
  -v /<CERT_DIRECTORY>/<CA_CERTS.pem>:/etc/rancher/ssl/cacerts.pem \
  rancher/rancher:latest
  
  
