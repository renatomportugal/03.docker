docker pull mysql:5.7
dcoker pull phpmyadmin/phpmyadmin

__REDE
docker network ls
docker network create mysql
docker network inspect mysql

__Rodar o MySQL
docker run \
    -d \
    -p 3306:3306 \
    -e MYSQL_ROOT_PASSWORD=my-password \
    -e MYSQL_USER=root \
    -e MYSQL_PASSWORD=my-password \
    --network mysql \
    --name mysql.5.7 \
    mysql:5.7 

416

__Rodar o PHPmyadmin
docker run \
    -d \
    -p 8080:80 \
    -e PMA_HOST=mysql.5.7 \
    --network mysql \
    --name phpmyadmin \
    phpmyadmin/phpmyadmin

c81

Para impedir o acesso externo deve alterar uma configuração, primeiro copie o arquivo para a máquina
docker cp 88:/etc/mysql/mysql.conf.d/mysqld.cnf mysqld.cnf

Comentar (colocando a cerquilha da frente)
#bind-address	= 127.0.0.1

Copiar de volta
docker cp mysqld.cnf 88:/etc/mysql/mysql.conf.d/mysqld.cnf

Reinicia o docker
docker restart 88

docker ps

acesse localhos:8080
usuário root senha my-password

_____________________________________________________________________________________
Por padáo a pasta que guarda os dados é /var/lib/mysql
docker exec -it <id> bash
cd /var/lib/mysql

Para fazer backup dos dados abra outra janela de terminal e poie a pasta
cd ~
mkdir volumemysql
cd volumemysql
docker cp <id>:/var/lib/mysql .

Para terstar se o backup deu certo crie outro container mysql e outro phpmyadmin (use as portas 3307 e 8081)
docker run \
    -d \
    -p 3307:3306 \
    -e MYSQL_ROOT_PASSWORD=my-password \
    -e MYSQL_USER=root \
    -e MYSQL_PASSWORD=my-password \
    --network mysql \
    --name mysql.5.7.3307 \
    mysql:5.7

226

docker run \
    -d \
    -p 8081:80 \
    -e PMA_HOST=mysql.5.7.3307 \
    --network mysql \
    --name phpmyadmin.8081 \
    phpmyadmin/phpmyadmin

28d

Acesse o localhost:8081 para ver se tudo está certo. Agora iremos passar o conteúdo da pasta volumemysql/mysql para a pasta de dados do mysql.5.7.3307.
cd ~/volumesql/mysql
docker cp . 226:/var/lib/mysql

Agora acesse a pasta mysql do 226 para mudar o dono:
docker exec 226 -t bash
cd /var/lib
ls -la
chown -R mysql mysql
cd mysql
ls -la

Reinicie o container do mysql
docker restart 226

Acesse o localhost:8081 e verá que está funcionando. Se não reiniciar dará um erro ao acessar as tabelas.
Foi utilizado o mysql da mesma imagem. Para outros parâmetros faça outro estudo.
_____________________________________________________________________________________
Teste de volume

Iremos fazer um container mapeando o volume com uma pasta local.
Pare o container do mysql.5.7
docker stop 416

Renomeie para utilizarmos o mesmo host de phpmyadmin
docker rename 416 mysql.5.7.old

Para persistência de dados iremos criar uma pasta no root
cd /
sudo mkdir volumesdocker
cd volumesdocker
sudo mkdir mysql.5.7
cd mysql.5.7

docker run \
    -d \
    -p 3306:3306 \
    -e MYSQL_ROOT_PASSWORD=my-password \
    -e MYSQL_USER=root \
    -e MYSQL_PASSWORD=my-password \
    -v 
    --network mysql \
    --name mysql.5.7 \
    mysql:5.7
_____________________________________________________________________________________

vai aparecer uma mensagem de erro para especificar algumas variáveis.
MYSQL_ROOT_PASSWORD
MYSQL_ALLOW_EMPTY_PASSWORD
MYSQL_RANDOM_ROOT_PASSWORD


docker ps
docker --help
docker run -e MYSQL_ROOT_PASSWORD=my-password mysql

em outra janela de terminal
docker ps

verifique se a variável foi atribuída
docker exec 09 env
