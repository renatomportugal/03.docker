## mysql
```
docker pull mysql:5.7
docker pull phpmyadmin/phpmyadmin

__REDE
docker network ls
docker network create mysql
docker network inspect mysql

__Rodar o MySQL
docker run \
    -d \
    -p 3306:3306 \
    -e MYSQL_ROOT_PASSWORD=my-password \
    -e MYSQL_USER=root \
    -e MYSQL_PASSWORD=my-password \
    --network mysql \
    --name mysql.5.7 \
    --restart=always \
    mysql:5.7

416

__Rodar o PHPmyadmin
docker run \
    -d \
    -p 8080:80 \
    -e PMA_HOST=mysql.5.7 \
    --network mysql \
    --name phpmyadmin \
    --restart=always \
    phpmyadmin/phpmyadmin

c81

Para impedir o acesso externo deve alterar uma configuração, primeiro copie o arquivo para a máquina
docker cp 88:/etc/mysql/mysql.conf.d/mysqld.cnf mysqld.cnf

Comentar (colocando a cerquilha da frente)
#bind-address	= 127.0.0.1

Copiar de volta
docker cp mysqld.cnf 88:/etc/mysql/mysql.conf.d/mysqld.cnf

Reinicia o docker
docker restart 88

docker ps

acesse localhos:8080
usuário root senha my-password

_____________________________________________________________________________________
Por padáo a pasta que guarda os dados é /var/lib/mysql
docker exec -it <id> bash
cd /var/lib/mysql

Para fazer backup dos dados abra outra janela de terminal e poie a pasta
cd ~
mkdir volumemysql
cd volumemysql
docker cp <id>:/var/lib/mysql .

Para terstar se o backup deu certo crie outro container mysql e outro phpmyadmin (use as portas 3307 e 8081)
docker run \
    -d \
    -p 3307:3306 \
    -e MYSQL_ROOT_PASSWORD=my-password \
    -e MYSQL_USER=root \
    -e MYSQL_PASSWORD=my-password \
    --network mysql \
    --name mysql.5.7.3307 \
    mysql:5.7

226

docker run \
    -d \
    -p 8081:80 \
    -e PMA_HOST=mysql.5.7.3307 \
    --network mysql \
    --name phpmyadmin.8081 \
    phpmyadmin/phpmyadmin

28d

Acesse o localhost:8081 para ver se tudo está certo. Agora iremos passar o conteúdo da pasta volumemysql/mysql para a pasta de dados do mysql.5.7.3307.
cd ~/volumesql/mysql
docker cp . 226:/var/lib/mysql

Agora acesse a pasta mysql do 226 para mudar o dono:
docker exec 226 -t bash
cd /var/lib
ls -la
chown -R mysql mysql
cd mysql
ls -la

Reinicie o container do mysql
docker restart 226

Acesse o localhost:8081 e verá que está funcionando. Se não reiniciar dará um erro ao acessar as tabelas.
Foi utilizado o mysql da mesma imagem. Para outros parâmetros faça outro estudo.
_____________________________________________________________________________________
Persistência de dados (na pasta usuário)
Pare o docker e renomeie para criarmos outro com o mesmo nome.
Isso evita mudar o host do phpmyadmin.
docker ps
docker stop 416
docker rename 416 mysql.5.7.old

docker run \
    -d \
    -p 3306:3306 \
    -e MYSQL_ROOT_PASSWORD=my-password \
    -e MYSQL_USER=root \
    -e MYSQL_PASSWORD=my-password \
    -v ~/volumesdocker/mysql.5.7:/var/lib/mysql \
    --network mysql \
    --name mysql.5.7 \
    mysql:5.7

948
Tentei copiar a pasta, está travada.
docker stop 948
docker rm 948

Para manusear a pasta é necessário mudar o dono.
sudo chown -R root mysql.5.7

Fazendo um backup
mkdir mysql.5.7.bck
sudo cp -R mysql.5.7/ mysql.5.7.bck/

Veja que a pasta mysql.5.7 foi copiada para a pasta mysql.5.7.bck.Faremos...
cd mysql.5.7.bck
cd mysql.5.7
sudo cp -r * ..
cd ..
sudo rm -rf mysql.5.7

Agora iremos testar a criação de um container com volume externo de uma pasta existente.
docker run \
    -d \
    -p 3306:3306 \
    -e MYSQL_ROOT_PASSWORD=my-password \
    -e MYSQL_USER=root \
    -e MYSQL_PASSWORD=my-password \
    -v ~/volumemysql/mysql:/var/lib/mysql \
    --network mysql \
    --name mysql.5.7 \
    mysql:5.7
    
7a8

O Container foi criado com os dados que já estavam. Funcionou.
_____________________________________________________________________________________

vai aparecer uma mensagem de erro para especificar algumas variáveis.
MYSQL_ROOT_PASSWORD
MYSQL_ALLOW_EMPTY_PASSWORD
MYSQL_RANDOM_ROOT_PASSWORD


docker ps
docker --help
docker run -e MYSQL_ROOT_PASSWORD=my-password mysql

em outra janela de terminal
docker ps

verifique se a variável foi atribuída
docker exec 09 env
```